<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Batch SVG Background Marker</title>
<style>
  .svg-wrapper {
    display: inline-block;
    margin: 10px;
    border: 1px solid #ccc;
    padding: 5px;
    width: 200px;  /* fixed width for preview */
    height: 200px; /* fixed height for preview */
    overflow: hidden;
  }
  .svg-wrapper svg {
    width: 100%;
    height: 100%;
  }
  svg path {
    stroke: #333;
    fill: none;
    cursor: pointer;
  }
  svg path.selected {
    stroke: red;
    fill: rgba(255,0,0,0.2);
  }
</style>

  
</head>
<body>

<h2>Batch SVG Background Marker</h2>
<input type="file" id="fileInput" accept=".svg" multiple>
<div id="svgContainer"></div>
<br>
<button id="downloadBtn">Download Modified SVGs</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.11.0/jszip.min.js"></script>

<script>
const svgContainer = document.getElementById('svgContainer');
let svgs = [];

document.getElementById('fileInput').addEventListener('change', async (e) => {
  svgs = [];
  svgContainer.innerHTML = '';
  const files = Array.from(e.target.files);

  for (const file of files) {
    const text = await file.text();
    const wrapper = document.createElement('div');
    wrapper.className = 'svg-wrapper';
    wrapper.innerHTML = text;
    svgContainer.appendChild(wrapper);

    const svgEl = wrapper.querySelector('svg');
    if (!svgEl) continue;

    let selectedPath = null;

    // Add click handlers to paths inside <g>
    svgEl.querySelectorAll('g path').forEach(path => {
      path.addEventListener('click', () => {
        if (selectedPath) selectedPath.classList.remove('selected');
        selectedPath = path;
        path.classList.add('selected');
      });
    });

    svgs.push({ svgEl, fileName: file.name, getSelectedPath: () => selectedPath });
  }
});

document.getElementById('downloadBtn').addEventListener('click', async () => {
  if (!svgs.length) return alert('Load SVGs first!');

  const zip = new JSZip();

  svgs.forEach(({ svgEl, fileName, getSelectedPath }) => {
    const path = getSelectedPath();
    if (path) path.classList.add('icon-bg'); // set the class

    zip.file(fileName, svgEl.outerHTML);
  });

  const content = await zip.generateAsync({ type: 'blob' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(content);
  a.download = 'icons-modified.zip';
  a.click();
  URL.revokeObjectURL(a.href);
});
</script>

</body>
</html>
